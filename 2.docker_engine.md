# 도커 엔진
## 도커 이미지와 컨테이너
- 이미지(image) : 컨테이너를 생성할 때 필요한 요소 가상 머신의 ios와 비슷한 개념  
여러 개의 계층으로 된 바이너리 파일로 존재하며, 컨테이너를 생성하고 실행할 때 읽기 전용으로 사용  
[저장소 이름]/[이미지 이름]:[태그]의 형태로 구성  
저장소 이름 : 이미지가 저장된 장소로 default:docker hub  
이미지 이름 : 일반적으로 이미지가 어떤 역할로 명명  
태그 : 이미지의 버전 관리에 사용되며 default:lastest  
```
ex)
alicek106/ubuntu:14.04
ubuntu:lastes
```
- 컨테이너(contianer) : 이미지를 사용해 만들어진 독립적인 공간, 파일시스템과 격리된 시스템 자원 및 네트워크를 사용  
컨테이너는 목적에 맞도록 사용되며, 컨테이너의 작업 내용은 이미지에 저장되지 않아 원래 이미지는 영향을 받지 않으며 호스트와도 분리되어 애플리케이션을 설치하거나 삭제해도 다른 컨테이너와 호스트에는 변화가 없음  

## 컨테이너 다루기
- docker 버전 확인
```bash
docker -v
```
- 컨테이너  생성  
```bash
docker run -i -t ubuntu:14.04
```
-i -t 옵션은 컨테이너와 상호 입출력을 가능하게 하는 옵션  
- -i : 상호 입출력 옵션 
- -t : tty를 활성화 하여 bash shell을 사용하도록 컨테이너 설정  

docker run은 image가 로컬에 존재하지 않는 경우 자동으로 다운받아 실행
shell이 사용자와 호스트 이름으로 변경된 것을 통해 컨테이너 내부로 들어왔다는 것을 확인  

컨테이너를 종료하고 빠져나오기 위한 방법
1. exit
2. Ctrl + D

컨테이너를 종료시키지 않고 빠져나오는 방법
1. Ctrl + P, Q

컨테이너를 종료하면 작업했던 내용이 모두 삭제되기 때문에 개발을 위해서는 Ctrl + P,Q를 사용  

- 컨테이너 내려받기
```bash
docker pull centos:7
```
run과 달리 이미지를 다운받기만 하는 용도  

- docker images 확인
```bash
docker images
```

- 컨테이너 생성하기
```bash
docker create -i -t --name mycentos centos:7
```
컨테이너를 생성하기 위한 명령어로 --name를 통해서 컨테이너의 이름을 설정하는 것이 가능  
위의 명령어를 실행하는 경우 컨테이너 내부로 들어가지 않는데 run과 달리 create는 컨테이너를 생성하고 컨테이너의 내부로 들어가지는 않음  

- 컨테이너 시작하기
```bash
docker start mycentos
```
start 명령어를 통해 컨테이너 이름으로 지정했던 mycentos를 실행

- 컨테이너 들어가기
```bash
docker attach mycentos
```
컨테이너 내부에 접속  

일반적으로는 하나의 단계씩 진행하지 않고 docker run을 통해 이미지를 다운받는 것부터 시작하고 컨테이너 내부에 들어가는 것까지 하나의 명령어로 실행  

컨테이너의 이름을 지정하지 않는 경우 컨테이너는 임의의 id를 가지며 임의의 id중 일부만 사용하여 컨테이너에 대한 명령을 실행  

- 컨테이너 목록 확인
```bash
docker ps
```
정지되지 않은 목록만 확인할 수 있으며, 정지된 컨테이너까지 모두 확인하려는 경우 -a 옵션 사용

- 컨테이너 삭제
```bash
docker rm
```
현재 실행중이지 않은 컨테이너를 삭제하는 명령어로 삭제하고자 하는 경우 컨테이너를 중지한 후 삭제를 진행하거나 강제로 삭제하기 위해 -f 옵션을 사용

- 사용중이지 않은 모든 컨테이너 삭제
```bash
docker container prune
```

- 컨테이너 중지
```bash
docker stop
```

- 명령어 조합을 이용하여 docker 컨테이너 제거
```bash
docker stop $(docker ps -a -q)
docker rm $(docker ps -a -q)
```
